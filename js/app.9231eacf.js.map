{"version":3,"file":"js/app.9231eacf.js","mappings":"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","sources":["webpack://vue-avatar/./src/App.vue","webpack://vue-avatar/./src/App.vue?aa4d","webpack://vue-avatar/./src/ui/ui-button.vue","webpack://vue-avatar/./src/ui/ui-button.vue?3b96","webpack://vue-avatar/./src/ui/ui-spinner.vue","webpack://vue-avatar/./src/ui/ui-spinner.vue?cccb","webpack://vue-avatar/./src/composables/useAvatar.ts","webpack://vue-avatar/./src/composables/useQueue.ts","webpack://vue-avatar/./src/composables/useMicrophone.ts","webpack://vue-avatar/./src/composables/useDeepgram.ts","webpack://vue-avatar/./src/composables/useOpenAI.ts","webpack://vue-avatar/./src/views/HomeView.vue?404b","webpack://vue-avatar/./src/views/HomeView.vue","webpack://vue-avatar/./src/views/HomeView.vue?7533","webpack://vue-avatar/./src/router/index.ts","webpack://vue-avatar/./src/main.ts","webpack://vue-avatar/webpack/bootstrap","webpack://vue-avatar/webpack/runtime/chunk loaded","webpack://vue-avatar/webpack/runtime/compat get default export","webpack://vue-avatar/webpack/runtime/define property getters","webpack://vue-avatar/webpack/runtime/ensure chunk","webpack://vue-avatar/webpack/runtime/get javascript chunk filename","webpack://vue-avatar/webpack/runtime/get mini-css chunk filename","webpack://vue-avatar/webpack/runtime/global","webpack://vue-avatar/webpack/runtime/hasOwnProperty shorthand","webpack://vue-avatar/webpack/runtime/load script","webpack://vue-avatar/webpack/runtime/make namespace object","webpack://vue-avatar/webpack/runtime/publicPath","webpack://vue-avatar/webpack/runtime/jsonp chunk loading","webpack://vue-avatar/webpack/startup"],"sourcesContent":["<template>\n  <router-view />\n</template>\n\n<style>\n#app {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n}\n\nnav {\n  padding: 30px;\n}\n\nnav a {\n  font-weight: bold;\n  color: #2c3e50;\n}\n\nnav a.router-link-exact-active {\n  color: #42b983;\n}\n</style>\n","import { render } from \"./App.vue?vue&type=template&id=0a506232\"\nconst script = {}\n\nimport \"./App.vue?vue&type=style&index=0&id=0a506232&lang=css\"\n\nimport exportComponent from \"../node_modules/.pnpm/vue-loader@17.4.2_vue@3.4.21_webpack@5.91.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<script setup lang=\"ts\">\n</script>\n<template>\n  <button class=\"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800\">\n    <slot></slot>\n  </button>\n</template>","import { render } from \"./ui-button.vue?vue&type=template&id=7add9e02\"\nconst script = {}\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.4.21_webpack@5.91.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<script setup lang=\"ts\">\n</script>\n<template>\n  <div role=\"status\">\n    <svg aria-hidden=\"true\" class=\"inline w-6 h-6 text-gray-200 animate-spin dark:text-gray-600 fill-blue-600\" viewBox=\"0 0 100 101\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z\" fill=\"currentColor\"/>\n        <path d=\"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z\" fill=\"currentFill\"/>\n    </svg>\n    <span class=\"sr-only\">Loading...</span>\n</div>\n</template>","import { render } from \"./ui-spinner.vue?vue&type=template&id=4087897a\"\nconst script = {}\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.4.21_webpack@5.91.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { nextTick, ref, Ref } from 'vue';\n\nconst SERVER_URL = process.env.VUE_APP_HEYGET_SERVER_URL;\nconst apiKey = process.env.VUE_APP_HEYGEN_API_KEY;\n\ntype ICEServer = {\n  urls: string[];\n  username: string;\n  credential: string;\n};\ntype SessionInfo = {\n  ice_servers2: ICEServer[];\n  sdp: any;\n  session_id: string;\n};\n\n// handle audio\n\nconst mediaStreamSource = ref<MediaStreamAudioSourceNode | undefined>()\n\nconst shouldRenderCanvas =ref(true)\nconst isError = ref(false);\nconst state = ref<'started' | 'stopped'>('stopped')\nconst errorMessage = ref('');\nconst mediaCanPlay = ref(false);\nconst isLoading = ref(false);\nconst isGenerating = ref(false);\nconst sessionInfo = ref<SessionInfo>();\nconst peerConnection = ref<RTCPeerConnection>();\nconst remoteStream = ref<MediaStream>();\nconst triggerRemoteStream = ref(0)\nconst iceConnectionState = ref<RTCIceConnectionState>();\n\nexport const useAvatar = (incomingVideoRef: Ref<HTMLVideoElement | undefined>, incomingCanvasRef: Ref<HTMLCanvasElement | undefined>) => {\n  const start =  async() => {\n    isLoading.value = true;\n    shouldRenderCanvas.value = true\n    await checkSessionsAndCloseIfExists()\n    // create new session\n    await new Promise((res, rej) => {\n      setTimeout(async () => {\n        await createNewSession(incomingVideoRef, incomingCanvasRef)\n        res(1)\n      },300)\n    })\n    await new Promise((res, rej) => {\n      setTimeout(async () => {\n        await startAndDisplaySession()\n        res(1)\n      }, 300)\n    })\n    isLoading.value = false\n    state.value = 'started'\n  }\n\n  return {\n    isError,\n    isGenerating,\n    state,\n    errorMessage,\n    mediaCanPlay,\n    isLoading,\n    sessionInfo,\n    peerConnection,\n    remoteStream,\n    renderCanvas,\n    triggerRemoteStream,\n    closeConnection: closeConnectionHandler,\n    iceConnectionState,\n    start,\n    generateVoice: async (text: string) => {\n      if (sessionInfo.value) {\n        isGenerating.value = true\n        await repeat(sessionInfo.value?.session_id, text)\n      }\n    }\n  };\n};\n\nconst createNewSession = async (videoRef: Ref<HTMLVideoElement | undefined>, canvasRef: Ref<HTMLCanvasElement | undefined>) => {\n  const avatarID = process.env.VUE_APP_HEYGEN_AVATAR_ID || '';\n  const voiceID = process.env.VUE_APP_HEYGEN_VOICE_ID || '';\n\n  // call the new interface to get the server's offer SDP and ICE server to create a new RTCPeerConnection\n  sessionInfo.value = await newSession('low', avatarID, voiceID);\n  if (sessionInfo.value) {\n    const { sdp: serverSdp, ice_servers2: iceServers } = sessionInfo.value;\n\n    // Create a new RTCPeerConnection\n    peerConnection.value = new RTCPeerConnection({ iceServers: iceServers });\n\n    // When audio and video streams are received, display them in the video element\n    // RASUL: instead of displaying in element we save it to the ref, then return it from composable\n    peerConnection.value.ontrack = (event) => {\n      console.log('Received the track');\n      if (event.track.kind === 'audio' || event.track.kind === 'video') {\n        remoteStream.value = event.streams[0];\n        triggerRemoteStream.value++\n\n        if (event.track.kind === 'audio') {\n          const audioContext = new AudioContext()\n          const audioAnalyzer = audioContext.createAnalyser()\n          const source = audioContext.createMediaStreamSource(event.streams[0])\n          source.connect(audioContext.destination)\n          const analyzer = audioContext.createAnalyser()\n          analyzer.connect(audioContext.destination)\n          analyzer.fftSize = 64;\n          setInterval(() => {\n            let frequencyData = new Uint8Array(analyzer.frequencyBinCount);\n            analyzer.getByteFrequencyData(frequencyData);\n            if (frequencyData.join('') !== \"00000000000000000000000000000000\") {\n              alert('there is some data')\n              console.log(frequencyData)\n            }\n            \n          }, 1000)\n        }\n        if (videoRef.value) {\n\n          videoRef.value.srcObject = event.streams[0];\n\n          if (videoRef.value.paused)  {\n            videoRef.value.play().then(_ => {}).catch(() => {})\n          }\n          if (shouldRenderCanvas.value) {\n            shouldRenderCanvas.value = false\n            setTimeout(() => {\n              renderCanvas(canvasRef, videoRef)\n            }, 500)\n          }\n        }\n      }\n    };\n    // When receiving a message, save it in the status ref\n    peerConnection.value.ondatachannel = (event) => {\n      const dataChannel = event.channel;\n      dataChannel.onmessage = (event) => {\n        // console.log('Recieved message:', event.data);\n        setTimeout(() => {\n          isGenerating.value = false\n        }, 400)\n      };\n    };\n    // Set server's SDP as remote description\n    const remoteDescription = new RTCSessionDescription(serverSdp);\n    await peerConnection.value.setRemoteDescription(remoteDescription);\n  }\n};\n\nconst startAndDisplaySession = async () => {\n  if (!sessionInfo.value || !peerConnection.value) return;\n\n  // Create and set local SDP description\n  const localDescription = await peerConnection.value.createAnswer();\n  await peerConnection.value.setLocalDescription(localDescription);\n\n  // When ICE candidate is available, send to the server\n  peerConnection.value.onicecandidate = ({ candidate }) => {\n    console.log('Received ICE candidate:', candidate);\n    setTimeout(() => {\n      if (candidate && sessionInfo.value) {\n        handleICE(sessionInfo.value.session_id, candidate.toJSON());\n      }\n    }, 300);\n  };\n\n  // When ICE connection state changes, display the new state\n  peerConnection.value.oniceconnectionstatechange = (event) => {\n    iceConnectionState.value = peerConnection.value?.iceConnectionState;\n  };\n\n  // Start session\n  await startSession(sessionInfo.value.session_id, localDescription);\n  console.log('Session Started Successfully');\n};\n\nasync function newSession(\n  quality: 'high' | 'medium' | 'low',\n  avatar_name: string,\n  voice_id: string,\n) {\n  const response = await fetch(`${SERVER_URL}/v1/streaming.new`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'X-Api-Key': apiKey,\n    },\n    body: JSON.stringify({\n      quality,\n      avatar_name,\n      voice: {\n        voice_id: voice_id,\n        rate: 1.25\n      },\n    }),\n  });\n  if (response.status === 500) {\n    console.error('Server error');\n    isError.value = true;\n    errorMessage.value = 'Server Error. Please ask the staff if the service has been turned on';\n    // updateStatus(\n    //   statusElement,\n    //   'Server Error. Please ask the staff if the service has been turned on',\n    // );\n\n    throw new Error('Server error');\n  } else {\n    const data = await response.json();\n    console.log(data.data);\n    return data.data;\n  }\n}\n// submit the ICE candidate\nasync function handleICE(session_id: string, candidate: RTCIceCandidateInit) {\n  const response = await fetch(`${SERVER_URL}/v1/streaming.ice`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'X-Api-Key': apiKey,\n    },\n    body: JSON.stringify({ session_id, candidate }),\n  });\n  if (response.status === 500) {\n    console.error('Server error');\n    isError.value = true;\n    errorMessage.value = 'Server Error. Please ask the staff if the service has been turned on';\n    // updateStatus(\n    //   statusElement,\n    //   'Server Error. Please ask the staff if the service has been turned on',\n    // );\n    throw new Error('Server error');\n  } else {\n    const data = await response.json();\n    return data;\n  }\n}\n// start the session\nasync function startSession(session_id: string, sdp: any) {\n  const response = await fetch(`${SERVER_URL}/v1/streaming.start`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'X-Api-Key': apiKey,\n    },\n    body: JSON.stringify({ session_id, sdp }),\n  });\n  if (response.status === 500) {\n    console.error('Server error');\n    isError.value = true;\n    errorMessage.value = 'Server Error. Please ask the staff if the service has been turned on';\n\n    // updateStatus(\n    //   statusElement,\n    //   'Server Error. Please ask the staff if the service has been turned on',\n    // );\n    throw new Error('Server error');\n  } else {\n    const data = await response.json();\n    return data.data;\n  }\n}\n\nasync function closeConnectionHandler() {\n  if (!sessionInfo.value || !peerConnection.value) {\n    // already closed\n    return;\n  }\n  renderID.value++\n  mediaCanPlay.value = false;\n  \n  console.log('closing connection...');\n  try {\n    // Close local connection\n    peerConnection.value.close();\n    // Call the close interface\n    const resp = await stopSession(sessionInfo.value.session_id);\n    state.value = 'stopped'\n    console.log('conneciton closed');\n    console.log(resp);\n  } catch (err) {\n    console.error('Failed to close the connection:', err);\n  }\n}\n\nconst checkSessionsAndCloseIfExists = async () => {\n  const data = await getSessionsList()\n  const sessionsData = data.data\n  if (sessionsData.sessions && sessionsData.sessions.length > 0) {\n    sessionsData.sessions.forEach(async (s: any) => {\n      await stopSession(s.session_id)\n    })\n  }\n}\n\nasync function getSessionsList () {\n  const options = {\n    method: 'GET',\n    headers: {\n      accept: 'application/json',\n      'x-api-key': apiKey\n    }\n  };\n  \n  const response = await fetch(`${SERVER_URL}/v1/streaming.list`, options).then(response => response.json())\n  return response\n}\n\n// stop session\nasync function stopSession(session_id: string) {\n  const response = await fetch(`${SERVER_URL}/v1/streaming.stop`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'X-Api-Key': apiKey,\n    },\n    body: JSON.stringify({ session_id }),\n  });\n  if (response.status === 500) {\n    console.error('Server error');\n    isError.value = true;\n    errorMessage.value = 'Server Error. Please ask the staff for help';\n    // updateStatus(statusElement, 'Server Error. Please ask the staff for help');\n    throw new Error('Server error');\n  } else {\n    const data = await response.json();\n    return data.data;\n  }\n}\nasync function repeat(session_id: string, text: string) {\n  const response = await fetch(`${SERVER_URL}/v1/streaming.task`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'X-Api-Key': apiKey,\n    },\n    body: JSON.stringify({ session_id, text }),\n  });\n  if (response.status === 500) {\n    console.error('Server error');\n    // updateStatus(\n    //   statusElement,\n    //   'Server Error. Please ask the staff if the service has been turned on',\n    // );\n    throw new Error('Server error');\n  } else {\n    const data = await response.json();\n    return data.data;\n  }\n}\n\nlet renderID = ref(0)\nconst renderCanvas = (canvasRef: Ref<HTMLCanvasElement | undefined>, videoRef: Ref<HTMLVideoElement | undefined>) => {\n  // init renderID\n  const curRenderID = Math.trunc(Math.random() * 1000000000)\n  renderID.value = curRenderID\n  // get canvas context\n  const ctx = canvasRef.value.getContext('2d', { willReadFrequently: true });\n\n\n  function process_frame () {\n    if (curRenderID !== renderID.value) {\n      return\n    }\n    // If streaming is not\n    if (!videoRef.value.videoHeight || !videoRef.value.videoWidth) {\n      setTimeout(() => {\n        process_frame()\n      }, 200)\n      return\n    }\n\n    // set dimestions\n    canvasRef.value.width = videoRef.value.videoWidth;\n    canvasRef.value.height = videoRef.value.videoHeight;\n    \n    // drawing frame\n    ctx.drawImage(videoRef.value, 0, 0, canvasRef.value.width, canvasRef.value.height)\n    ctx.getContextAttributes().willReadFrequently = true;\n    \n    const imageData = ctx.getImageData(0, 0, canvasRef.value.width, canvasRef.value.height);\n    const data = imageData.data;\n\n    for (let i = 0; i < data.length; i += 4) {\n      const red = data[i];\n      const green = data[i + 1];\n      const blue = data[i + 2];\n\n      // You can implement your own logic here\n      if (isCloseToGreen([red, green, blue])) {\n        // if (isCloseToGray([red, green, blue])) {\n        data[i + 3] = 0;\n      }\n    }\n\n    ctx.putImageData(imageData, 0, 0);\n    requestAnimationFrame(process_frame);\n  }\n\n  process_frame();\n}\nfunction isCloseToGreen(color) {\n  const [red, green, blue] = color;\n  return green > 90 && red < 90 && blue < 90;\n}\n","import { Ref, computed, ref } from 'vue';\n\n\nexport default function useQueue<T>(initialValue: T[] = []) {\n  const queue = ref<T[]>(initialValue) as Ref<T[]>\n\n  const add = (el: T) => {\n    queue.value = [...queue.value, el]\n  }\n\n\n  const remove = () => {\n    const [first, ...q] = queue.value\n    queue.value = q\n\n    return first;\n  }\n\n  const clear = () => {\n    queue.value = []\n  }\n\n  return {\n    add,\n    remove,\n    clear,\n    first: computed<T>(() => queue.value[0]),\n    last: computed<T>(() => queue.value[queue.value.length - 1]),\n    size: computed(() => queue.value.length),\n    queue,\n  };\n}","import { computed, onBeforeUnmount, onMounted, ref, watch } from \"vue\";\nimport useQueue from \"./useQueue\";\n\nlet microphone = ref<MediaRecorder>();\nlet microphoneIsOpen = ref(false);\nconst {\n  add: enqueueBlob,\n  remove: removeBlob,\n  first: firstBlob,\n  size: queueSize,\n  queue,\n} = useQueue<Blob>();\n\nconst isRecording = ref(false)\n\nexport default function useMicrophone() {\n  const eventer = () =>\n    document.visibilityState !== \"visible\" && stopMicrophone();\n  onMounted(() => {\n    window.addEventListener(\"visibilitychange\", eventer);\n  });\n  onBeforeUnmount(() => {\n    window.removeEventListener(\"visibilitychange\", eventer);\n    if (microphone.value) microphone.value.ondataavailable = null;\n  });\n\n  watch(microphone, (val) => {\n    if (val) {\n      val.ondataavailable = (e) => {\n        if (microphoneIsOpen.value) {\n          enqueueBlob(e.data);\n        }\n      };\n    }\n  });\n\n  setupMicrophone();\n\n  return {\n    microphone,\n    microphoneIsOpen,\n    startMicrophone,\n    stopMicrophone,\n    queue,\n    isRecording,\n    enqueueBlob,\n    removeBlob,\n    firstBlob,\n    queueSize,\n  }\n}\n\nconst setupMicrophone = async () => {\n  const userMedia = await navigator.mediaDevices.getUserMedia({\n    audio: {\n      noiseSuppression: true,\n      echoCancellation: true,\n    },\n  });\n\n  microphone.value = new MediaRecorder(userMedia);\n};\n\nconst stopMicrophone = () => {\n  if (microphone.value.state === \"recording\") {\n    isRecording.value = false\n    const waiting = setTimeout(() => {\n      clearTimeout(waiting);\n      microphone.value.pause();\n      microphoneIsOpen.value = false;\n    }, 1500);\n  }\n};\n\nconst startMicrophone = () => {\n  if (microphone.value.state === \"paused\") {\n    microphone.value.resume();\n  } else {\n    microphone.value.start(250);\n  }\n  microphoneIsOpen.value = true\n  isRecording.value = true\n};\n","import {\n  CreateProjectKeyResponse,\n  LiveClient,\n  LiveSchema,\n  LiveTranscriptionEvents,\n  LiveTranscriptionEvent,LiveConnectionState,\n  SpeakSchema,\n} from \"@deepgram/sdk\";\nimport { onBeforeUnmount, ref, watch } from \"vue\";\nimport useQueue from \"./useQueue\";\n/**\n * TTS Voice Options\n */\nconst voices: {\n  [key: string]: {\n    name: string;\n    avatar: string;\n    language: string;\n    accent: string;\n  };\n} = {\n  \"aura-asteria-en\": {\n    name: \"Asteria\",\n    avatar: \"/aura-asteria-en.svg\",\n    language: \"English\",\n    accent: \"US\",\n  },\n};\nconst voiceMap = (model: string) => {\n  return voices[model];\n};\nconst getApiKey = async (): Promise<string> => {\n  // const result: CreateProjectKeyResponse = await (\n  //   await fetch(\"/api/authenticate\", { cache: \"no-store\" })\n  // ).json();\n  return process.env.VUE_APP_DEEPGRAM_API\n\n};\n\nconst connection = ref<LiveClient>();\nconst isConnecting = ref(false);\nconst connectionIsReady = ref(false);\nlet transcript = ref({\n  isFinal: true,\n  text: \"\"\n})\n\nconst connect = async () => {\n  console.log('connect outer')\n  if (!connection.value && !isConnecting.value) {\n    isConnecting.value = true;\n    \n    console.log('connect inner')\n    connection.value = new LiveClient(\n      await getApiKey(),\n      {\n        \n      },\n      {\n        language: 'ru',\n        model: \"nova-2\",\n        interim_results: true,\n        smart_format: true,\n        endpointing: 350,\n        utterance_end_ms: 1000,\n        filler_words: true,\n      }\n    );\n    isConnecting.value = false\n  }\n};\n\nconst keepAlive = () => {\n  let interval;\n  if (connection.value && connectionIsReady) {\n    interval = setInterval(() => {\n      if (connection.value && connection.value.getReadyState() !== LiveConnectionState.OPEN) {\n        clearInterval(interval)\n      } else {\n        if (connection.value) {\n          connection.value.keepAlive()\n        }\n      }\n    }, 10000)\n  } else {\n    if (interval) {\n      clearInterval(interval)\n    }\n  }\n}\n\nconst setupListeners = () => {\n  if (connection.value && connection.value.getReadyState() !== undefined) {\n\n    connection.value.addListener(LiveTranscriptionEvents.Open, () => {\n      connectionIsReady.value = true\n    })\n    \n    connection.value.addListener(LiveTranscriptionEvents.Close, () => {\n      // toast(\"The connection to Deepgram closed, we'll attempt to reconnect.\");\n      clear()\n    })\n\n    connection.value.addListener(LiveTranscriptionEvents.Error, () => {\n      // toast(\n      //   \"An unknown error occured. We'll attempt to reconnect to Deepgram.\"\n      // );\n      clear()\n    })\n    connection.value.addListener(LiveTranscriptionEvents.Metadata, (data) => {\n      console.log(data, 'Metadata')\n    })\n    connection.value.addListener(LiveTranscriptionEvents.Transcript, (data: LiveTranscriptionEvent) => {\n      // console.log(data, 'Transcript')\n      if (data.channel.alternatives[0].transcript) {\n        transcript.value = {\n          isFinal: data.is_final,\n          text: data.channel.alternatives[0].transcript\n        }\n      }\n    })\n  }\n}\n\nconst clear = () => {\n  if (connection.value) {\n    connectionIsReady.value = false\n    connection.value.removeAllListeners()\n    connection.value = undefined\n  }\n}\n\nexport default function useDeepgram(lang: 'ru' | 'en') {\n  const start = async () => {\n    await connect()\n    setupListeners()\n  }\n  start()\n\n  watch(connection, () => {\n    keepAlive()\n  })\n  onBeforeUnmount(()=> {\n    clear()\n  })\n\n  return {\n    connection,\n    isConnecting,\n    transcript,\n    connectionIsReady\n  }\n}\n","import { computed, ref } from \"vue\";\n\nconst API_KEY = process.env.VUE_APP_OPENAI_API_KEY;\nconst textArray = ref<string[]>([])\ntype Message = {\n  role: \"user\" | \"assistant\" | \"system\";\n  content: string;\n};\nconst messages = ref<Message[]>([{\n  role: 'system',\n  content: 'Do not write long text. Your limit is 500 symbols. Try to reply only in this limits.'\n}]);\n\nconst gtpIsStreaming = ref(false)\nconst currentMessage = ref(\"\")\nconst currentWord = ref(\"\")\nexport default function useOpenAI() {\n  return {\n    currentMessage,\n    textArr: textArray,\n    arrSize: computed(() => textArray.value.length),\n    currentWord,\n    gtpIsStreaming,\n    messages,\n    sendMessage\n  };\n}\n\nconst sendCompetions = async () => {\n  return await fetch(\"https://api.openai.com/v1/chat/completions\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${API_KEY}`,\n    },\n    body: JSON.stringify({\n      model: \"gpt-3.5-turbo\",\n      temperature: 0.7,\n      stream: true,\n      max_tokens: 1000,\n      messages: messages.value,\n    }),\n  });\n};\n\nconst sendMessage = async (text: string) => {\n  messages.value.push({\n    role: \"user\",\n    content: text,\n  });\n  const stream = await sendCompetions();\n  gtpIsStreaming.value = true\n  const reader = stream.body.getReader();\n  const decoder = new TextDecoder(\"utf-8\");\n\n  while (true) {\n    const { done, value } = await reader.read();\n\n    if (done) break;\n    // Massage and parse the chunk of data\n    const chunk = decoder.decode(value);\n     // Clean up the data\n    const lines = chunk\n    .split(\"\\n\")\n    .map((line) => line.replace(\"data: \", \"\"))\n    .filter((line) => line.length > 0)\n    .filter((line) => line !== \"[DONE]\")\n    .map((line) => {\n      try {\n        return JSON.parse(line)\n      } catch {\n        console.log(line)\n        return \"\"\n      }\n    });\n  \n    for (const parsedLine of lines) {\n      const { choices } = parsedLine;\n      if (choices && choices.length) {\n        const { delta, finish_reason } = choices[0];\n        const { content } = delta;\n        \n        if (content) {\n          // currentWord.value = content\n          currentMessage.value += content\n  \n          textArray.value.push(content)\n        }\n        if (finish_reason) {\n          gtpIsStreaming.value = false\n          messages.value.push({\n            role: 'assistant',\n            content: currentMessage.value\n          })\n          // currentMessage.value = \"\"\n        }\n      }\n    }\n  }\n}\n","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, createElementVNode as _createElementVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, toDisplayString as _toDisplayString, createElementBlock as _createElementBlock, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass } from \"vue\"\n\nconst _hoisted_1 = { class: \"home flex flex-col justify-center items-center bg-blue-900 py-4 px-4\" }\nconst _hoisted_2 = { class: \"flex z-[2] flex-col items-center space-y-2\" }\nconst _hoisted_3 = { class: \"flex items-center space-x-2\" }\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Start Connection\", -1)\nconst _hoisted_5 = { class: \"flex relative flex-col w-full items-center\" }\nconst _hoisted_6 = /*#__PURE__*/_createElementVNode(\"div\", { class: \"absolute inset-x-0 m-auto h-80 max-w-lg bg-gradient-to-tr from-indigo-400 via-teal-900 to-[#C084FC] blur-[118px]\" }, null, -1)\nconst _hoisted_7 = { class: \"flex items-start sm:flex-wrap sm:justify-center\" }\nconst _hoisted_8 = {\n  key: 0,\n  class: \"text-white w-[250px] sm:w-full z-[2] text-left\"\n}\nconst _hoisted_9 = /*#__PURE__*/_createElementVNode(\"span\", { class: \"font-bold text-purple-300\" }, \"avatar:\", -1)\nconst _hoisted_10 = {\n  key: 1,\n  class: \"text-white w-[300px] sm:w-full z-[2]\"\n}\nconst _hoisted_11 = /*#__PURE__*/_createElementVNode(\"span\", { class: \"font-bold text-red-300\" }, \"user:\", -1)\nconst _hoisted_12 = {\n  key: 0,\n  class: \"my-4 flex space-x-2 justify-center items-center\"\n}\nconst _hoisted_13 = /*#__PURE__*/_createElementVNode(\"div\", { class: \"h-2 w-2 bg-white rounded-full animate-bounce [animation-delay:-0.3s]\" }, null, -1)\nconst _hoisted_14 = /*#__PURE__*/_createElementVNode(\"div\", { class: \"h-2 w-2 bg-white rounded-full animate-bounce [animation-delay:-0.15s]\" }, null, -1)\nconst _hoisted_15 = /*#__PURE__*/_createElementVNode(\"div\", { class: \"h-2 w-2 bg-white rounded-full animate-bounce\" }, null, -1)\nconst _hoisted_16 = [\n  _hoisted_13,\n  _hoisted_14,\n  _hoisted_15\n]\nconst _hoisted_17 = { class: \"flex space-x-2 sm:flex-wrap sm:justify-center\" }\nconst _hoisted_18 = /*#__PURE__*/_createElementVNode(\"div\", { class: \"flex items-center space-x-2\" }, [\n  /*#__PURE__*/_createElementVNode(\"span\", null, \"Start Recording\")\n], -1)\nconst _hoisted_19 = /*#__PURE__*/_createElementVNode(\"div\", { class: \"flex items-center space-x-2\" }, [\n  /*#__PURE__*/_createElementVNode(\"span\", null, \"Stop Recording\")\n], -1)\nconst _hoisted_20 = /*#__PURE__*/_createElementVNode(\"div\", { class: \"text-white flex sm:w-full text-center sm:justify-center items-center\" }, \"or\", -1)\nconst _hoisted_21 = { class: \"flex items-center space-x-2\" }\nconst _hoisted_22 = { key: 0 }\nconst _hoisted_23 = { key: 1 }\nconst _hoisted_24 = { class: \"bg-white w-full my-4 py-2 min-h-[300px] max-h-[300px] overflow-auto rounded-md flex flex-col items-center\" }\nconst _hoisted_25 = /*#__PURE__*/_createElementVNode(\"div\", { class: \"font-bold text-[18px]\" }, \"Chat:\", -1)\nconst _hoisted_26 = { class: \"border-t\" }\nconst _hoisted_27 = { class: \"flex flex-wrap justify-center\" }\nconst _hoisted_28 = { class: \"bg-slate-200 font-mono p-4 w-[400px] min-h-[200px] mt-4\" }\nconst _hoisted_29 = /*#__PURE__*/_createElementVNode(\"h1\", { class: \"font-bold text-[20px]\" }, \"OpenAI\", -1)\nconst _hoisted_30 = { class: \"bg-slate-200 font-mono p-4 w-[400px] min-h-[200px] mt-4\" }\nconst _hoisted_31 = /*#__PURE__*/_createElementVNode(\"h1\", { class: \"font-bold text-[20px]\" }, \"HeyGen RTC connection\", -1)\nconst _hoisted_32 = { class: \"bg-slate-200 font-mono p-4 w-[400px] min-h-[200px] mt-4\" }\nconst _hoisted_33 = /*#__PURE__*/_createElementVNode(\"h1\", { class: \"font-bold text-[20px]\" }, \"Microphone Info\", -1)\nconst _hoisted_34 = { class: \"bg-slate-200 font-mono p-4 w-[400px] min-h-[200px] mt-4\" }\nconst _hoisted_35 = /*#__PURE__*/_createElementVNode(\"h1\", { class: \"font-bold text-[20px]\" }, \"Deepgram API\", -1)\n\nimport { ref, watch } from \"vue\";\nimport UIButton from \"@/ui/ui-button.vue\";\nimport UIInput from \"@/ui/ui-input.vue\";\nimport UISpinner from \"@/ui/ui-spinner.vue\";\nimport { useAvatar } from \"@/composables/useAvatar\";\nimport useMicroPhone from \"@/composables/useMicrophone\";\nimport useDeepgram from \"@/composables/useDeepgram\";\nimport useOpenAI from \"@/composables/useOpenAI\";\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'HomeView',\n  setup(__props) {\n\nlet isProcessing = ref(false);\nlet userText = ref(\"...\");\nlet avatarText = ref(\"...\");\n\nconst chatMessages = ref<{\n  text: string,\n  role: 'user' | 'assistant'\n}[]>([])\n\nconst {\n  sendMessage,\n  messages,\n  currentMessage,\n  gtpIsStreaming,\n  currentWord,\n  textArr,\n} = useOpenAI();\nconst { connection, isConnecting, transcript, connectionIsReady } =\n  useDeepgram(\"ru\");\nconst {\n  isRecording,\n  microphoneIsOpen,\n  queue,\n  microphone,\n  firstBlob,\n  removeBlob,\n  queueSize,\n  startMicrophone,\n  stopMicrophone,\n} = useMicroPhone();\nconst videoRef = ref<HTMLVideoElement>();\nconst canvasRef = ref<HTMLCanvasElement>();\nconst {\n  renderCanvas,\n  isLoading,\n  isGenerating,\n  iceConnectionState,\n  closeConnection,\n  state,\n  isError,\n  errorMessage,\n  mediaCanPlay,\n  generateVoice,\n  start,\n} = useAvatar(videoRef, canvasRef);\nlet text = ref(\" ,  ?\");\n\nwatch(currentMessage, (v) => {\n  if (v) avatarText.value = v\n})\n\nwatch([currentMessage, gtpIsStreaming], ([value]) => {\n  \n  if (value && !gtpIsStreaming.value) {\n    console.log(value)\n    chatMessages.value.push({\n      role: 'assistant',\n      text: value\n    })\n    if (value.length > 200) {\n      console.log (`${value} is longer than 100`)\n      console.log ('split it to 2')\n      const fn = async () => {  \n        const arr = value.split(' ')\n        const halfIndex = Math.ceil(arr.length / 2);\n        let firstHalf = arr.slice(0, halfIndex).join(' ');\n        console.log('sending first:' + firstHalf)\n        await generateVoice(firstHalf)\n        let secondHalf = arr.slice(halfIndex).join(' ');\n        setTimeout(() => {\n          console.log('sending second:' + secondHalf)\n          generateVoice(secondHalf)\n        }, 2000)\n      }\n      \n      fn()\n    } else {\n      console.log('sending:', value)\n      generateVoice(value);\n    }\n    avatarText.value = value;\n    currentMessage.value = \"\";\n  }\n});\n\n\nconst processQueue = () => {\n  if (queueSize.value > 0 && !isProcessing.value) {\n    isProcessing.value = true;\n\n    if (connectionIsReady.value) {\n      const nextBlob = firstBlob.value;\n\n      if (nextBlob && nextBlob.size > 0) {\n        connection.value.send(nextBlob);\n      }\n      removeBlob();\n    }\n    // timeout?\n    isProcessing.value = false;\n  }\n};\n\nwatch(queueSize, () => {\n  processQueue();\n});\n\nwatch(transcript, (val) => {\n  // call openAI\n  userText.value = val.text;\n  if (val.isFinal && !gtpIsStreaming.value) {\n    chatMessages.value.push({\n      role: 'user',\n      text: val.text\n    })\n    sendMessage(val.text);\n  }\n});\n\nconst onStopRecording = () => {\n  stopMicrophone();\n  setTimeout(() => {\n    if (\n      !isRecording &&\n      !transcript.value.isFinal &&\n      transcript.value.text !== text.value\n    ) {\n      console.log(\"this case\");\n      text.value = transcript.value.text;\n    }\n  }, 1000);\n};\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      (_unref(state) === 'stopped')\n        ? (_openBlock(), _createBlock(UIButton, {\n            key: 0,\n            disabled: _unref(isLoading),\n            onClick: _unref(start)\n          }, {\n            default: _withCtx(() => [\n              _createElementVNode(\"div\", _hoisted_3, [\n                _hoisted_4,\n                (_unref(isLoading))\n                  ? (_openBlock(), _createBlock(UISpinner, { key: 0 }))\n                  : _createCommentVNode(\"\", true)\n              ])\n            ]),\n            _: 1\n          }, 8, [\"disabled\", \"onClick\"]))\n        : (_openBlock(), _createBlock(UIButton, {\n            key: 1,\n            onClick: _unref(closeConnection)\n          }, {\n            default: _withCtx(() => [\n              _createTextVNode(\"Stop Connection\")\n            ]),\n            _: 1\n          }, 8, [\"onClick\"]))\n    ]),\n    _createElementVNode(\"div\", _hoisted_5, [\n      _hoisted_6,\n      _createElementVNode(\"div\", _hoisted_7, [\n        (_unref(avatarText))\n          ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n              _hoisted_9,\n              _createTextVNode(\" \" + _toDisplayString(_unref(avatarText)), 1)\n            ]))\n          : _createCommentVNode(\"\", true),\n        _createElementVNode(\"video\", {\n          ref_key: \"videoRef\",\n          ref: videoRef,\n          class: \"my-4 hidden z-10 rounded-full max-h-[400px] min-h-[300px] border w-[300px]\",\n          autoPlay: \"\",\n          playsInline: \"\"\n        }, null, 512),\n        _createElementVNode(\"canvas\", {\n          ref_key: \"canvasRef\",\n          ref: canvasRef,\n          width: \"300\",\n          height: \"300\",\n          class: \"z-10 my-4 rounded-full max-h-[400px] h-[300px] flex border w-[300px]\"\n        }, null, 512),\n        (_unref(userText))\n          ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [\n              _hoisted_11,\n              _createTextVNode(\" \" + _toDisplayString(_unref(userText)), 1)\n            ]))\n          : _createCommentVNode(\"\", true)\n      ]),\n      (_unref(gtpIsStreaming) || _unref(isGenerating))\n        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_12, _hoisted_16))\n        : _createCommentVNode(\"\", true)\n    ]),\n    _createElementVNode(\"div\", _hoisted_17, [\n      _createVNode(UIButton, {\n        class: \"z-[2]\",\n        onClick: _unref(startMicrophone)\n      }, {\n        default: _withCtx(() => [\n          _hoisted_18\n        ]),\n        _: 1\n      }, 8, [\"onClick\"]),\n      _createVNode(UIButton, {\n        class: \"z-[2]\",\n        onClick: _unref(stopMicrophone)\n      }, {\n        default: _withCtx(() => [\n          _hoisted_19\n        ]),\n        _: 1\n      }, 8, [\"onClick\"]),\n      _hoisted_20,\n      _createVNode(UIButton, {\n        class: \"z-[2]\",\n        onTouchstart: _unref(startMicrophone),\n        onTouchend: onStopRecording,\n        onMousedown: _unref(startMicrophone),\n        onMouseup: onStopRecording\n      }, {\n        default: _withCtx(() => [\n          _createElementVNode(\"div\", _hoisted_21, [\n            (!_unref(isRecording))\n              ? (_openBlock(), _createElementBlock(\"span\", _hoisted_22, \"Hold to Record\"))\n              : (_openBlock(), _createElementBlock(\"span\", _hoisted_23, \"Recording...\")),\n            (_unref(isRecording))\n              ? (_openBlock(), _createBlock(UISpinner, { key: 2 }))\n              : _createCommentVNode(\"\", true)\n          ])\n        ]),\n        _: 1\n      }, 8, [\"onTouchstart\", \"onMousedown\"])\n    ]),\n    _createElementVNode(\"div\", _hoisted_24, [\n      _hoisted_25,\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(chatMessages.value, (msg, index) => {\n        return (_openBlock(), _createElementBlock(\"div\", {\n          class: \"max-w-[300px] flex\",\n          key: index\n        }, [\n          _createElementVNode(\"div\", _hoisted_26, [\n            _createElementVNode(\"span\", {\n              class: _normalizeClass([\"font-bold\", {'text-red-400': msg.role === 'user', 'text-purple-800': msg.role === 'assistant'}])\n            }, _toDisplayString(msg.role) + \": \", 3),\n            _createTextVNode(\" \" + _toDisplayString(msg.text), 1)\n          ])\n        ]))\n      }), 128))\n    ]),\n    _createElementVNode(\"div\", _hoisted_27, [\n      _createElementVNode(\"div\", _hoisted_28, [\n        _hoisted_29,\n        _createElementVNode(\"p\", null, \"currentWord: \" + _toDisplayString(_unref(currentWord)), 1),\n        _createElementVNode(\"p\", null, \"currentMessage: \" + _toDisplayString(_unref(currentMessage)), 1),\n        _createElementVNode(\"p\", null, \"messages: \" + _toDisplayString(_unref(messages)), 1),\n        _createElementVNode(\"p\", null, \"gtpIsStreaming: \" + _toDisplayString(_unref(gtpIsStreaming)), 1)\n      ]),\n      _createElementVNode(\"div\", _hoisted_30, [\n        _hoisted_31,\n        _createElementVNode(\"p\", null, \"isLoading: \" + _toDisplayString(_unref(isLoading)), 1),\n        _createElementVNode(\"p\", null, \"isGenerating: \" + _toDisplayString(_unref(isGenerating)), 1),\n        _createElementVNode(\"p\", null, \"iceConnectionState: \" + _toDisplayString(_unref(iceConnectionState)), 1),\n        _createElementVNode(\"p\", null, \"isError: \" + _toDisplayString(_unref(isError)), 1),\n        _createElementVNode(\"p\", null, \"errorMessage: \" + _toDisplayString(_unref(errorMessage)), 1)\n      ]),\n      _createElementVNode(\"div\", _hoisted_32, [\n        _hoisted_33,\n        _createElementVNode(\"p\", null, \"isRecording: \" + _toDisplayString(_unref(isRecording)), 1),\n        _createElementVNode(\"p\", null, \"microphone: \" + _toDisplayString(_unref(microphone) && _unref(microphone).state), 1),\n        _createElementVNode(\"p\", null, \"microphoneIsOpen: \" + _toDisplayString(_unref(microphoneIsOpen)), 1),\n        _createElementVNode(\"p\", null, \"queue: \" + _toDisplayString(_unref(queue)), 1),\n        _createElementVNode(\"p\", null, \"queueSize: \" + _toDisplayString(_unref(queueSize)), 1)\n      ]),\n      _createElementVNode(\"div\", _hoisted_34, [\n        _hoisted_35,\n        _createElementVNode(\"p\", null, \"transcript: \" + _toDisplayString(_unref(transcript)), 1),\n        _createElementVNode(\"p\", null, \"isProcessing: \" + _toDisplayString(_unref(isProcessing)), 1),\n        _createElementVNode(\"p\", null, \"connection: \" + _toDisplayString(_unref(connection) !== undefined), 1),\n        _createElementVNode(\"p\", null, \"isConnecting: \" + _toDisplayString(_unref(isConnecting)), 1),\n        _createElementVNode(\"p\", null, \"connectionIsReady: \" + _toDisplayString(_unref(connectionIsReady)), 1)\n      ])\n    ])\n  ]))\n}\n}\n\n})","<script setup lang=\"ts\">\nimport { ref, watch } from \"vue\";\nimport UIButton from \"@/ui/ui-button.vue\";\nimport UIInput from \"@/ui/ui-input.vue\";\nimport UISpinner from \"@/ui/ui-spinner.vue\";\nimport { useAvatar } from \"@/composables/useAvatar\";\nimport useMicroPhone from \"@/composables/useMicrophone\";\nimport useDeepgram from \"@/composables/useDeepgram\";\nimport useOpenAI from \"@/composables/useOpenAI\";\n\nlet isProcessing = ref(false);\nlet userText = ref(\"...\");\nlet avatarText = ref(\"...\");\n\nconst chatMessages = ref<{\n  text: string,\n  role: 'user' | 'assistant'\n}[]>([])\n\nconst {\n  sendMessage,\n  messages,\n  currentMessage,\n  gtpIsStreaming,\n  currentWord,\n  textArr,\n} = useOpenAI();\nconst { connection, isConnecting, transcript, connectionIsReady } =\n  useDeepgram(\"ru\");\nconst {\n  isRecording,\n  microphoneIsOpen,\n  queue,\n  microphone,\n  firstBlob,\n  removeBlob,\n  queueSize,\n  startMicrophone,\n  stopMicrophone,\n} = useMicroPhone();\nconst videoRef = ref<HTMLVideoElement>();\nconst canvasRef = ref<HTMLCanvasElement>();\nconst {\n  renderCanvas,\n  isLoading,\n  isGenerating,\n  iceConnectionState,\n  closeConnection,\n  state,\n  isError,\n  errorMessage,\n  mediaCanPlay,\n  generateVoice,\n  start,\n} = useAvatar(videoRef, canvasRef);\nlet text = ref(\" ,  ?\");\n\nwatch(currentMessage, (v) => {\n  if (v) avatarText.value = v\n})\n\nwatch([currentMessage, gtpIsStreaming], ([value]) => {\n  \n  if (value && !gtpIsStreaming.value) {\n    console.log(value)\n    chatMessages.value.push({\n      role: 'assistant',\n      text: value\n    })\n    if (value.length > 200) {\n      console.log (`${value} is longer than 100`)\n      console.log ('split it to 2')\n      const fn = async () => {  \n        const arr = value.split(' ')\n        const halfIndex = Math.ceil(arr.length / 2);\n        let firstHalf = arr.slice(0, halfIndex).join(' ');\n        console.log('sending first:' + firstHalf)\n        await generateVoice(firstHalf)\n        let secondHalf = arr.slice(halfIndex).join(' ');\n        setTimeout(() => {\n          console.log('sending second:' + secondHalf)\n          generateVoice(secondHalf)\n        }, 2000)\n      }\n      \n      fn()\n    } else {\n      console.log('sending:', value)\n      generateVoice(value);\n    }\n    avatarText.value = value;\n    currentMessage.value = \"\";\n  }\n});\n\n\nconst processQueue = () => {\n  if (queueSize.value > 0 && !isProcessing.value) {\n    isProcessing.value = true;\n\n    if (connectionIsReady.value) {\n      const nextBlob = firstBlob.value;\n\n      if (nextBlob && nextBlob.size > 0) {\n        connection.value.send(nextBlob);\n      }\n      removeBlob();\n    }\n    // timeout?\n    isProcessing.value = false;\n  }\n};\n\nwatch(queueSize, () => {\n  processQueue();\n});\n\nwatch(transcript, (val) => {\n  // call openAI\n  userText.value = val.text;\n  if (val.isFinal && !gtpIsStreaming.value) {\n    chatMessages.value.push({\n      role: 'user',\n      text: val.text\n    })\n    sendMessage(val.text);\n  }\n});\n\nconst onStopRecording = () => {\n  stopMicrophone();\n  setTimeout(() => {\n    if (\n      !isRecording &&\n      !transcript.value.isFinal &&\n      transcript.value.text !== text.value\n    ) {\n      console.log(\"this case\");\n      text.value = transcript.value.text;\n    }\n  }, 1000);\n};\n</script>\n<template>\n  <div class=\"home flex flex-col justify-center items-center bg-blue-900 py-4 px-4\">\n    <div class=\"flex z-[2] flex-col items-center space-y-2\">\n      <UIButton v-if=\"state === 'stopped'\" :disabled=\"isLoading\" @click=\"start\">\n        <div class=\"flex items-center space-x-2\">\n          <span>Start Connection</span>\n          <UISpinner v-if=\"isLoading\" />\n        </div>\n      </UIButton>\n      <UIButton v-else @click=\"closeConnection\">Stop Connection</UIButton>\n    </div>\n    <div class=\"flex relative flex-col w-full items-center\">\n      <div\n        class=\"absolute inset-x-0 m-auto h-80 max-w-lg bg-gradient-to-tr from-indigo-400 via-teal-900 to-[#C084FC] blur-[118px]\"\n      ></div>\n      <div class=\"flex items-start sm:flex-wrap sm:justify-center\">\n        <div v-if=\"avatarText\" class=\"text-white w-[250px] sm:w-full z-[2] text-left\">\n          <span class=\"font-bold text-purple-300\">avatar:</span>\n          {{ avatarText }}\n        </div>\n        <video\n          ref=\"videoRef\"\n          class=\"my-4 hidden z-10 rounded-full max-h-[400px] min-h-[300px] border w-[300px]\"\n          autoPlay\n          playsInline\n        ></video>\n        <canvas\n          ref=\"canvasRef\"\n          width=\"300\"\n          height=\"300\"\n          class=\"z-10 my-4 rounded-full max-h-[400px] h-[300px] flex border w-[300px]\"\n        ></canvas>\n        <div v-if=\"userText\" class=\"text-white w-[300px] sm:w-full z-[2]\">\n          <span class=\"font-bold text-red-300\">user:</span> {{ userText }}\n        </div>\n      </div>\n      <div\n        v-if=\"gtpIsStreaming || isGenerating\"\n        class=\"my-4 flex space-x-2 justify-center items-center\"\n      >\n        <div\n          class=\"h-2 w-2 bg-white rounded-full animate-bounce [animation-delay:-0.3s]\"\n        ></div>\n        <div\n          class=\"h-2 w-2 bg-white rounded-full animate-bounce [animation-delay:-0.15s]\"\n        ></div>\n        <div class=\"h-2 w-2 bg-white rounded-full animate-bounce\"></div>\n      </div>\n    </div>\n    <div class=\"flex space-x-2 sm:flex-wrap sm:justify-center\">\n      <UIButton\n        class=\"z-[2]\"\n        @click=\"startMicrophone\"\n      >\n        <div class=\"flex items-center space-x-2\">\n          <span>Start Recording</span>\n        </div>\n      </UIButton>\n      <UIButton\n        class=\"z-[2]\"\n        @click=\"stopMicrophone\"\n      >\n        <div class=\"flex items-center space-x-2\">\n          <span>Stop Recording</span>\n        </div>\n      </UIButton>\n      <div class=\"text-white flex sm:w-full text-center sm:justify-center items-center\">or</div>\n      <UIButton\n        class=\"z-[2]\"\n        @touchstart=\"startMicrophone\"\n        @touchend=\"onStopRecording\"\n        @mousedown=\"startMicrophone\"\n        @mouseup=\"onStopRecording\"\n      >\n        <div class=\"flex items-center space-x-2\">\n          <span v-if=\"!isRecording\">Hold to Record</span>\n          <span v-else>Recording...</span>\n          <UISpinner v-if=\"isRecording\" />\n        </div>\n      </UIButton>\n    </div>\n    <div class=\"bg-white w-full my-4 py-2 min-h-[300px] max-h-[300px] overflow-auto rounded-md flex flex-col items-center\">\n      <div class=\"font-bold text-[18px]\">Chat:</div>\n      <div class=\"max-w-[300px] flex\" v-for=\"(msg, index) in chatMessages\" :key=\"index\">\n        <div class=\"border-t\">\n          <span class=\"font-bold\" :class=\"{'text-red-400': msg.role === 'user', 'text-purple-800': msg.role === 'assistant'}\">\n            {{ msg.role }}:\n          </span>\n          {{ msg.text }}\n        </div>\n      </div>\n    </div>\n    <div class=\"flex flex-wrap justify-center\">\n      <div class=\"bg-slate-200 font-mono p-4 w-[400px] min-h-[200px] mt-4\">\n        <h1 class=\"font-bold text-[20px]\">OpenAI</h1>\n        <p>currentWord: {{ currentWord }}</p>\n        <p>currentMessage: {{ currentMessage }}</p>\n        <p>messages: {{ messages }}</p>\n        <p>gtpIsStreaming: {{ gtpIsStreaming }}</p>\n      </div>\n      <div class=\"bg-slate-200 font-mono p-4 w-[400px] min-h-[200px] mt-4\">\n        <h1 class=\"font-bold text-[20px]\">HeyGen RTC connection</h1>\n        <p>isLoading: {{ isLoading }}</p>\n        <p>isGenerating: {{ isGenerating }}</p>\n        <p>iceConnectionState: {{ iceConnectionState }}</p>\n        <p>isError: {{ isError }}</p>\n        <p>errorMessage: {{ errorMessage }}</p>\n      </div>\n      <div class=\"bg-slate-200 font-mono p-4 w-[400px] min-h-[200px] mt-4\">\n        <h1 class=\"font-bold text-[20px]\">Microphone Info</h1>\n        <p>isRecording: {{ isRecording }}</p>\n        <p>microphone: {{ microphone && microphone.state }}</p>\n        <p>microphoneIsOpen: {{ microphoneIsOpen }}</p>\n        <p>queue: {{ queue }}</p>\n        <p>queueSize: {{ queueSize }}</p>\n      </div>\n      <div class=\"bg-slate-200 font-mono p-4 w-[400px] min-h-[200px] mt-4\">\n        <h1 class=\"font-bold text-[20px]\">Deepgram API</h1>\n        <p>transcript: {{ transcript }}</p>\n        <p>isProcessing: {{ isProcessing }}</p>\n        <p>connection: {{ connection !== undefined }}</p>\n        <p>isConnecting: {{ isConnecting }}</p>\n        <p>connectionIsReady: {{ connectionIsReady }}</p>\n      </div>\n    </div>\n  </div>\n</template>\n","import script from \"./HomeView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./HomeView.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { createRouter, createWebHistory, RouteRecordRaw } from 'vue-router';\nimport HomeView from '../views/HomeView.vue';\n\nconst routes: Array<RouteRecordRaw> = [\n  {\n    path: '/',\n    name: 'home',\n    component: HomeView,\n  },\n  {\n    path: '/about',\n    name: 'about',\n    // route level code-splitting\n    // this generates a separate chunk (about.[hash].js) for this route\n    // which is lazy-loaded when the route is visited.\n    component: () => import(/* webpackChunkName: \"about\" */ '../views/AboutView.vue'),\n  },\n];\n\nconst router = createRouter({\n  history: createWebHistory(process.env.BASE_URL),\n  routes,\n});\n\nexport default router;\n","import './index.css';\nimport { createApp } from 'vue';\nimport App from './App.vue';\nimport router from './router';\n\ncreateApp(App).use(router).mount('#app');\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"js/\" + \"about\" + \".\" + \"171433dc\" + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var inProgress = {};\nvar dataWebpackPrefix = \"vue-avatar:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = function(url, done, key, chunkId) {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = function(prev, event) {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach(function(fn) { return fn(event); });\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/avatar-vue/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t524: 0\n};\n\n__webpack_require__.f.j = function(chunkId, promises) {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise(function(resolve, reject) { installedChunkData = installedChunks[chunkId] = [resolve, reject]; });\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = function(event) {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkvue_avatar\"] = self[\"webpackChunkvue_avatar\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [504], function() { return __webpack_require__(2534); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["_createBlock","_component_router_view","script","__exports__","render","class","_createElementBlock","_hoisted_1","_renderSlot","_ctx","$slots","role","_createElementVNode","viewBox","fill","xmlns","d","_hoisted_2","_hoisted_3","_hoisted_4","SERVER_URL","process","apiKey","shouldRenderCanvas","ref","isError","state","errorMessage","mediaCanPlay","isLoading","isGenerating","sessionInfo","peerConnection","remoteStream","triggerRemoteStream","iceConnectionState","useAvatar","incomingVideoRef","incomingCanvasRef","start","async","value","checkSessionsAndCloseIfExists","Promise","res","rej","setTimeout","createNewSession","startAndDisplaySession","renderCanvas","closeConnection","closeConnectionHandler","generateVoice","repeat","session_id","text","videoRef","canvasRef","avatarID","voiceID","newSession","sdp","serverSdp","ice_servers2","iceServers","RTCPeerConnection","ontrack","event","console","log","track","kind","streams","audioContext","AudioContext","source","createAnalyser","createMediaStreamSource","connect","destination","analyzer","fftSize","setInterval","frequencyData","Uint8Array","frequencyBinCount","getByteFrequencyData","join","alert","srcObject","paused","play","then","_","catch","ondatachannel","dataChannel","channel","onmessage","remoteDescription","RTCSessionDescription","setRemoteDescription","localDescription","createAnswer","setLocalDescription","onicecandidate","candidate","handleICE","toJSON","oniceconnectionstatechange","startSession","quality","avatar_name","voice_id","response","fetch","method","headers","body","JSON","stringify","voice","rate","status","error","Error","data","json","renderID","close","resp","stopSession","err","getSessionsList","sessionsData","sessions","length","forEach","s","options","accept","curRenderID","Math","trunc","random","ctx","getContext","willReadFrequently","process_frame","videoHeight","videoWidth","width","height","drawImage","getContextAttributes","imageData","getImageData","i","red","green","blue","isCloseToGreen","putImageData","requestAnimationFrame","color","useQueue","initialValue","queue","add","el","remove","first","q","clear","computed","last","size","microphone","microphoneIsOpen","enqueueBlob","removeBlob","firstBlob","queueSize","isRecording","useMicrophone","eventer","document","visibilityState","stopMicrophone","onMounted","window","addEventListener","onBeforeUnmount","removeEventListener","ondataavailable","watch","val","e","setupMicrophone","startMicrophone","userMedia","navigator","mediaDevices","getUserMedia","audio","noiseSuppression","echoCancellation","MediaRecorder","waiting","clearTimeout","pause","resume","getApiKey","connection","isConnecting","connectionIsReady","transcript","isFinal","LiveClient","language","model","interim_results","smart_format","endpointing","utterance_end_ms","filler_words","keepAlive","interval","getReadyState","LiveConnectionState","OPEN","clearInterval","setupListeners","undefined","addListener","LiveTranscriptionEvents","Open","Close","Metadata","Transcript","alternatives","is_final","removeAllListeners","useDeepgram","lang","API_KEY","textArray","messages","content","gtpIsStreaming","currentMessage","currentWord","useOpenAI","textArr","arrSize","sendMessage","sendCompetions","Authorization","temperature","stream","max_tokens","push","reader","getReader","decoder","TextDecoder","done","read","chunk","decode","lines","split","map","line","replace","filter","parse","parsedLine","choices","delta","finish_reason","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","key","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_defineComponent","__name","setup","__props","isProcessing","userText","avatarText","chatMessages","useMicroPhone","v","fn","arr","halfIndex","ceil","firstHalf","slice","secondHalf","processQueue","nextBlob","send","onStopRecording","_cache","_openBlock","_unref","UIButton","disabled","onClick","default","_withCtx","UISpinner","_createCommentVNode","_createTextVNode","_toDisplayString","ref_key","autoPlay","playsInline","_createVNode","onTouchstart","onTouchend","onMousedown","onMouseup","_Fragment","_renderList","msg","index","_normalizeClass","routes","path","name","component","HomeView","router","createRouter","history","createWebHistory","createApp","App","use","mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","call","m","deferred","O","result","chunkIds","priority","notFulfilled","Infinity","fulfilled","j","Object","keys","every","splice","r","n","getter","__esModule","a","definition","o","defineProperty","enumerable","get","f","chunkId","all","reduce","promises","u","miniCssF","g","globalThis","this","Function","obj","prop","prototype","hasOwnProperty","inProgress","dataWebpackPrefix","l","url","needAttach","scripts","getElementsByTagName","getAttribute","createElement","charset","timeout","nc","setAttribute","src","onScriptComplete","prev","onerror","onload","doneFns","parentNode","removeChild","bind","type","target","head","appendChild","Symbol","toStringTag","p","installedChunks","installedChunkData","promise","resolve","reject","loadingEnded","errorType","realSrc","message","request","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","id","chunkLoadingGlobal","self","__webpack_exports__"],"sourceRoot":""}